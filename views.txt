/* 
-------------------------------------
View 1: WarehouseRentalActivity
-------------------------------------
Description:
This view provides a detailed summary of how many total rentals have been handled by each warehouse across the organization. 
By linking the Warehouses, Drones, and Rentals tables, it shows how active each warehouse is in supporting member requests through its assigned drones. 
The output presents each warehouse’s ID, its manager’s full name, and the total number of rentals processed, offering a clear operational snapshot of warehouse activity.

Business Justification:
From an administrator’s perspective, this view is vital for monitoring performance across all warehouse locations and ensuring resources are aligned with demand. 
By observing which warehouses process the highest number of rentals, administrators can make informed decisions about staffing levels, storage capacity, and drone deployment. 
It also assists in identifying underperforming locations that may require operational review or promotional support to increase member engagement. 
In the long term, this data can support budgeting, expansion planning, and strategic adjustments to improve overall service efficiency.
*/
CREATE VIEW WarehouseRentalActivity AS
SELECT 
    w.WarehouseID,
    w.ManagerFirstName || ' ' || w.ManagerLastName AS ManagerName,
    COUNT(r.RentalNumber) AS TotalRentals
FROM Warehouses AS w
JOIN Drones AS d ON w.WarehouseID = d.WarehouseID
JOIN Rentals AS r ON d.SerialNumber = r.DroneSerialNumber
GROUP BY w.WarehouseID, ManagerName;

/*
-------------------------------------
View 2: DroneUsageSummary
-------------------------------------
Description:
This view highlights drone utilization within the rental system by displaying each drone’s total number of deliveries and the number of unique users it has served. 
By combining the Drones and Rentals tables, it reveals which drones are most active in deliveries and which ones serve the widest range of members. 
The result helps provide a measurable understanding of the organization’s delivery workload distribution.

Business Justification:
For an administrator, this view provides essential insight into how evenly the drone fleet is being used across the service area. 
By tracking the number of deliveries and distinct users per drone, administrators can detect overused drones that may need maintenance or replacement, as well as identify underused units that could be reassigned to busier warehouses. 
This supports balanced scheduling, improves fleet reliability, and helps prevent downtime or service interruptions. 
Administrators can also use this data to forecast maintenance costs and ensure operational readiness across all delivery routes.
*/
CREATE VIEW DroneUsageSummary AS
SELECT 
    d.SerialNumber AS DroneSerialNumber,
    d.Model,
    COUNT(r.RentalNumber) AS TotalDeliveries,
    COUNT(DISTINCT r.UserID) AS UniqueUsersServed
FROM Drones AS d
JOIN Rentals AS r ON d.SerialNumber = r.DroneSerialNumber
GROUP BY d.SerialNumber, d.Model
ORDER BY TotalDeliveries DESC;
